# 希冀DDL小助手

## 背景

考完离散期中的阳光明媚的下午，想到一位好友**屡次**错过（或差点错过）希冀上的作业ddl后，复习不进去计组的我打算研究一个工具。
它可以获取希冀平台上的作业信息，把尚未完成的作业的信息发到邮箱里，从而有效避免我们忘记作业ddl。

## 概述

希冀DDL小助手（CGDDLHelper）是一款用于自动检查希冀平台作业提交状态，并通过电子邮件提醒用户的Python程序。它能够登录到武汉大学计算机学院专业课一体化平台，抓取作业信息，并将未完成的作业通过邮件发送给用户。

## 环境要求

- Python 3.x
- `requests`库
- `BeautifulSoup`库（来自`bs4`）
- `Pillow`库（用于处理图像）
- `smtplib`库（用于发送邮件）
- `json`库（用于配置文件处理）

## 安装依赖

确保已安装必要的库，可以使用以下命令安装：
```bash
pip install requests beautifulsoup4 Pillow
```

## 配置步骤

- 你可以不用自行创建配置文件，在没有配置文件的情况下，使用程序时会要求你输入相关信息并自动为你创建配置文件。
- 但是你需要自己完成发件人邮箱的smtp服务的开启，已提供相应的pdf教程（本程序使用qq邮箱的smtp服务）

1. **创建配置文件**
   - 在项目目录下创建一个名为 `config.json` 的文件，内容格式如下：
     ```json
     {
         "sender_email": "发件人邮箱",
         "recipient_email": "收件人邮箱",
         "sender_password": "发件人邮箱密码(指独立的 SMTP 授权码)"
     }
     ```
   - 将你的邮箱和密码替换为实际信息。
   - 注意，邮箱密码为独立的 SMTP 授权码，本程序使用了qq的smtp服务，并写了简单的开启qq的smtp服务、获取授权码的教学。当然你也可以自行修改相应的代码，并使用其他邮箱提供的服务
2. **创建凭据文件**
   - 在项目目录下创建一个名为 `credentials.json` 的文件，内容格式如下：
     ```json
     {
         "stid": "你的学号",
         "pwd": "你的密码"
     }
     ```
   - 将学号和密码替换为实际信息。

## 使用程序

1. **运行程序**
   在命令行中运行以下命令启动程序：
   ```bash
   python CGDDLHelper.py
   ```

2. **输入信息**
   - 如果没有提供学号和密码，程序会提示你输入。
   - 如果没有找到配置文件，程序会提示输入发件人邮箱、密码、收件人。

3. **验证码**
   - 程序会自动获取验证码并显示图像，用户**需手动输入验证码**。

4. **登录**
   - 程序会尝试登录学校网站，如果用户名、密码或验证码错误，会提示相应错误信息。

5. **检查作业**
   - 登录成功后，程序会检查所有课程的作业状态，并收集未完成的作业信息。

6. **发送邮件**
   - 如果有未完成的作业，程序会将作业信息格式化，并发送到指定的收件人邮箱。

7. **查看结果**
   - 程序运行完成后，终端将显示未完成的作业信息，邮件也会发送到指定的邮箱。
   - 若目前没有未完成的作业，终端也会有响应提示

## 注意事项

- 确保填写的邮箱信息和密码正确。
- 若使用QQ邮箱，请确保已开启SMTP服务。
- 确保网络连接正常，以便程序能够访问学校网站和发送邮件。
- 如遇其他问题，欢迎交流

## 欢迎大家改进的地方

由于本人技艺不精，并且非常不熟悉python，并且开始开发时计组期中考试在即，时间较为紧迫，本程序在很多地方并不够好，功能上也很可能存在漏洞。所以欢迎大家批指正，也欢迎有兴趣的朋友来帮助完善改进这个工具。
当然，如果你觉得我写的是一坨，想要设计一个更好的程序，我也分享了我在设计爬虫时的思路，你可以查看相应的pdf，这或许可以为你省去一些工作。

以下是我能想到的一些改进的地方：

### 代码可读性和健壮性

大部分都是GPT写的，无需多言......

### 使用逻辑优化

比如支持学号和密码的重新输入，验证码输错后重新获取等......

### 验证码自动识别

在开发过程中，我尝试利用了tesseract ocr去识别验证码的内容，但是效果不好，如果能破解验证码，本工具将会更加自动化......



好的，这是一个简洁明了的 `README.md` 文件，你可以直接复制使用。它包含了项目介绍、功能、如何安装和使用，以及注意事项。

---

# 希冀平台在线作业自动提醒脚本

这是一个 Python 脚本，旨在帮助用户自动监控希冀教学平台，并在老师发布新作业时通过系统通知和声音提醒用户。

## 主要功能

- **自动登录**：集成了基于 Tesseract 的 OCR 技术，可自动识别验证码进行登录。
- **智能提醒**：只在有**新**作业发布时进行提醒，避免重复打扰。
- **无人值守**：
  - OCR 识别失败时会自动重试，无需人工干预。
  - 当连续3分钟无法成功登录时，会通过**声音**和**弹窗**警报，提示用户手动输入验证码。
- **跨平台**：支持 Windows、macOS 和 Linux。
- **持久化存储**：已发现的作业列表和用户配置（学号、密码等）会保存在本地文件中，重启后依然有效。

## 环境要求

- Python 3.6+
- Tesseract OCR 引擎

## 安装指南

### 1. 克隆或下载项目

将本项目所有文件下载到你的本地文件夹。

### 2. 安装 Tesseract OCR

- **Windows**: 从 [Tesseract at UB Mannheim](https://github.com/UB-Mannheim/tesseract/wiki) 下载并安装。**务必记住你的安装路径**，例如 `C:\Program Files\Tesseract-OCR\tesseract.exe`。
- **macOS**: 使用 Homebrew: `brew install tesseract`
- **Linux (Debian/Ubuntu)**: `sudo apt update && sudo apt install tesseract-ocr`

### 3. 安装 Python 依赖库

在项目根目录下打开终端，运行以下命令：

```bash
pip install -r requirements.txt
```

如果没有 `requirements.txt` 文件，可以手动安装所有依赖：

```bash
pip install requests beautifulsoup4 Pillow plyer playsound==1.2.2 pytesseract opencv-python numpy
```

### 4. 准备警报声音文件

下载一个你喜欢的简短提示音（如 `.wav` 或 `.mp3` 格式），将其重命名为 `alert.wav`，并放在项目根目录下。（本项目默认提供了一个）

## 使用方法

1.  **运行通知测试脚本（可选但推荐）**
    在终端中运行测试脚本，确保你的系统通知和声音播放功能正常。

    ```bash
    python test_notification.py
    ```
    你应该能看到一个弹窗并听到一声提示音。

2.  **运行主脚本**
    ```bash
    python CGOnlineHWNotifier_Advanced_v3.py
    ```

3.  **首次配置**
    - 脚本会提示你输入学号和密码。
    - 如果你使用的是 Windows，脚本会自动检测并提示你输入 `tesseract.exe` 的完整路径。
    - 输入的信息将被保存在 `config.json` 文件中，下次运行时会自动加载。

4.  **让脚本在后台运行**
    配置完成后，脚本将开始每隔30秒自动检查一次。你可以将终端最小化，让它在后台持续运行。当有新作业或需要你手动干预时，它会主动提醒你。

## 注意事项

- **请求频率**：默认每30秒检查一次。如果遇到因访问频繁导致的问题，可以适当增大脚本中的 `CHECK_INTERVAL_SECONDS` 值。
- **OCR 识别率**：验证码识别成功率不保证100%。如果自动识别持续失败，脚本会触发手动输入模式。
- **网站更新**：如果希冀平台前端代码发生变化，可能会导致脚本解析失败。届时需要更新脚本中的 HTML 解析逻辑。
- **保持运行**：脚本需要保持运行状态才能进行监控。可以考虑使用 `nohup` (Linux/macOS) 或其他工具让它在后台稳定运行。
